# Alfred local development environment (copy to .env)
# Never use production credentials in this file.

# Core runtime
DATABASE_URL=postgres://postgres:postgres@127.0.0.1:5432/alfred
# Required by Clerk JWKS cache and LLM reliability state.
REDIS_URL=redis://127.0.0.1:6379/0
DATA_ENCRYPTION_KEY=dev-only-change-me
API_BIND_ADDR=127.0.0.1:8080

# Google OAuth (dev placeholders)
GOOGLE_OAUTH_CLIENT_ID=dev-client-id
GOOGLE_OAUTH_CLIENT_SECRET=dev-client-secret
GOOGLE_OAUTH_REDIRECT_URI=http://localhost/oauth/callback

# Clerk auth (dev placeholders)
CLERK_ISSUER=https://your-tenant.clerk.accounts.dev
CLERK_AUDIENCE=alfred-api
CLERK_SECRET_KEY=sk_test_replace_me
# Optional override. If omitted, backend uses https://api.clerk.com/v1
# CLERK_BACKEND_API_URL=https://api.clerk.com/v1
# Optional JWKS cache tuning
# CLERK_JWKS_CACHE_KEY=alfred:clerk:jwks:v1
# CLERK_JWKS_CACHE_DEFAULT_TTL_SECONDS=300
# CLERK_JWKS_CACHE_STALE_TTL_SECONDS=300

# Dev-only TEE/KMS toggles for local startup
ALFRED_ENV=local
ENCLAVE_RUNTIME_MODE=dev-shim
ENCLAVE_RUNTIME_BASE_URL=http://127.0.0.1:8181
ENCLAVE_RUNTIME_BIND_ADDR=127.0.0.1:8181
ENCLAVE_RUNTIME_PROBE_TIMEOUT_MS=2000
ENCLAVE_RUNTIME_MEASUREMENT=dev-local-enclave
TEE_ATTESTATION_REQUIRED=false
TEE_ALLOW_INSECURE_DEV_ATTESTATION=true
TEE_ATTESTATION_DOCUMENT={}
TEE_ALLOWED_MEASUREMENTS=dev-local-enclave
KMS_KEY_ID=kms/local/alfred-refresh-token
KMS_KEY_VERSION=1
ASSISTANT_INGRESS_ACTIVE_KEY_ID=assistant-ingress-v1
# Optional in local dev-shim; required outside local.
# ASSISTANT_INGRESS_ACTIVE_PRIVATE_KEY=<base64 32-byte x25519 private key>
# Optional previous key pair for rotation grace window.
# ASSISTANT_INGRESS_PREVIOUS_KEY_ID=assistant-ingress-v0
# ASSISTANT_INGRESS_PREVIOUS_PRIVATE_KEY=<base64 32-byte x25519 private key>
ASSISTANT_INGRESS_KEY_TTL_SECONDS=900
ASSISTANT_INGRESS_SESSION_TTL_SECONDS=3600

# Worker defaults (optional)
WORKER_TICK_SECONDS=30

# OpenRouter LLM provider (required for LLM backend startup)
OPENROUTER_API_KEY=or-local-dev-key
# Optional override. If omitted, backend uses https://openrouter.ai/api/v1/chat/completions
# OPENROUTER_CHAT_COMPLETIONS_URL=https://openrouter.ai/api/v1/chat/completions
OPENROUTER_TIMEOUT_MS=15000
OPENROUTER_MAX_RETRIES=2
OPENROUTER_RETRY_BASE_BACKOFF_MS=250
OPENROUTER_MAX_OUTPUT_TOKENS=600
# OPENROUTER_ALLOW_INSECURE_HTTP=true

# Global model routing (primary + fallback)
OPENROUTER_MODEL_PRIMARY=openai/gpt-4o-mini
OPENROUTER_MODEL_FALLBACK=anthropic/claude-3.5-haiku

# LLM reliability guardrails
LLM_RATE_LIMIT_WINDOW_SECONDS=60
LLM_RATE_LIMIT_GLOBAL_MAX_REQUESTS=120
LLM_RATE_LIMIT_PER_USER_MAX_REQUESTS=30
LLM_CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
LLM_CIRCUIT_BREAKER_COOLDOWN_SECONDS=60
LLM_CACHE_TTL_SECONDS=20
LLM_CACHE_MAX_ENTRIES=256
LLM_BUDGET_WINDOW_SECONDS=3600
LLM_BUDGET_MAX_ESTIMATED_COST_USD=1.0
LLM_BUDGET_MODEL=openai/gpt-4o-mini
